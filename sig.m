clear 
close all
pkg load signal
order = 6;
fs = 1000;
T = 1/fs;             % Sampling period       
L = 2048;             % Length of signal
t = (0:L-1)*T;
%mysig was created with gensindata(ptrsignal); in example.c
mysig = [0.000000,19.446206,9.980266,9.917450,20.274463,4.122139,-9.822872,5.524747,9.268802,-1.602860,9.510578,15.468655,-8.074462,-17.649266,-9.048270,-19.510575,-23.838657,0.274604,8.443270,-2.777868,5.877875,11.347387,-7.705163,-7.767917,12.175661,9.999996,6.845476,23.948299,19.460819,-5.167079,-5.877841,-3.402491,-20.199005,-16.454926,4.817557,-0.489437,-9.972852,1.468932,-3.681294,-21.649010,-9.510497,7.783202,2.486882,10.655627,28.844021,15.877809,-1.253342,6.262908,1.775431,-13.265874,0.000016,13.265857,-1.775455,-6.262864,1.253329,-15.877936,-28.843994,-10.655519,-2.486910,-7.783183,9.510621,21.648979,3.681193,-1.468919,9.972870,0.489352,-4.817542,16.454954,20.198935,3.402420,5.877855,5.167026,-19.460934,-23.948202,-6.845462,-10.000033,-12.175599,7.768072,7.705106,-11.347439,-5.877764,2.777862,-8.443298,-0.274479,23.838750,19.510552,9.048275,17.649299,8.074289,-15.468683,-9.510503,1.602846,-9.268885,-5.524707,9.822887,-4.122301,-20.274463,-9.917416,-9.980326,-19.446188,0.000041,19.446215,9.980201,9.917541,20.274461,4.122046,-9.822852,5.524885,9.268778,-1.602869,9.510687,15.468560,-8.074542,-17.649234,-9.048258,-19.510597,-23.838614,0.274728,8.443210,-2.777874,5.877926,11.347334,-7.705284,-7.767893,12.175724,10.000002,6.845491,23.948344,19.460703,-5.167193,-5.877757,-3.402600,-20.198972,-16.454897,4.817573,-0.489521,-9.972834,1.469022,-3.681468,-21.649086,-9.510555,7.783208,2.486875,10.655734,28.844049,15.877589,-1.253365,6.262888,1.775408,-13.265879,0.000135,13.265840,-1.775608,-6.262788,1.253296,-15.877878,-28.843986,-10.655490,-2.486937,-7.783164,9.510836,21.648926,3.681240,-1.468905,9.972875,0.489330,-4.817441,16.455137,20.198813,3.402329,5.877868,5.167004,-19.460965,-23.948183,-6.845371,-10.000133,-12.175490,7.767965,7.705082,-11.347454,-5.877742,2.777824,-8.443375,-0.274264,23.838869,19.510529,9.048277,17.649308,8.074255,-15.468789,-9.510343,1.602827,-9.268821,-5.524683,9.822891,-4.122335,-20.274469,-9.917308,-9.980434,-19.446165,0.000081,19.446219,9.980184,9.917558,20.274455,4.121826,-9.822821,5.525039,9.268764,-1.602872,9.510711,15.468544,-8.074761,-17.649177,-9.048244,-19.510620,-23.838595,0.274762,8.443198,-2.777911,5.878066,11.347243,-7.705439,-7.767868,12.175741,9.999902,6.845582,23.948466,19.460504,-5.167336,-5.877815,-3.402538,-20.199094,-16.454715,4.817674,-0.489667,-9.972802,1.469111,-3.681348,-21.649049,-9.510340,7.783241,2.486827,10.655921,28.844096,15.877741,-1.253349,6.262963,1.775255,-13.265908,-0.000007,13.265811,-1.775503,-6.262712,1.253312,-15.878470,-28.843939,-10.655618,-2.486985,-7.783187,9.511051,21.648963,3.680772,-1.468816,9.972854,0.489184,-4.817510,16.455320,20.198897,3.402239,5.877953,5.166617,-19.461164,-23.948268,-6.845279,-10.000064,-12.175382,7.768120,7.704666,-11.347545,-5.877839,2.777787,-8.443322,-0.274048,23.838787,19.510137,9.048292,17.649269,8.074036,-15.468716,-9.510184,1.602840,-9.269070,-5.524529,9.822871,-4.122555,-20.274465,-9.917199,-9.980359,-19.446141,0.000342,19.446282,9.980076,9.917484,20.274449,4.121978,-9.822791,5.524933,9.268515,-1.602891,9.510602,15.468438,-8.074610,-17.649121,-9.048254,-19.511012,-23.838477,0.274613,8.443121,-2.777885,5.878207,11.347306,-7.705594,-7.767713,12.175666,9.999802,6.845519,23.948589,19.460641,-5.167480,-5.877730,-3.402781,-20.199215,-16.454840,4.817776,-0.489566,-9.972771,1.469049,-3.681816,-21.649103,-9.510488,7.783274,2.486860,10.656107,28.844064,15.877149,-1.253373,6.262911,1.775102,-13.265888,0.000545,13.265831,-1.775914,-6.262764,1.253328,-15.878318,-28.843972,-10.655116,-2.486952,-7.783097,9.510903,21.648819,3.680892,-1.468877,9.972939,0.489284,-4.817238,16.455194,20.198570,3.402301,5.877894,5.166716,-19.461027,-23.947938,-6.845342,-10.000332,-12.175456,7.768014,7.704773,-11.347482,-5.877462,2.777813,-8.443528,-0.274197,23.838706,19.510238,9.048282,17.649421,8.074187,-15.469001,-9.510294,1.602788,-9.269007,-5.524635,9.822952,-4.122404,-20.274481,-9.917274,-9.980650,-19.446157,0.000163,19.446266,9.980150,9.917775,20.274453,4.121386,-9.822812,5.524827,9.268579,-1.602878,9.511030,15.468511,-8.075199,-17.649160,-9.048215,-19.510912,-23.838558,0.275192,8.443174,-2.777986,5.878110,11.347061,-7.705487,-7.767820,12.175958,9.999871,6.845765,23.948505,19.460105,-5.167381,-5.877789,-3.402718,-20.199132,-16.454349,4.817706,-0.489958,-9.972792,1.468988,-3.681696,-21.649066,-9.509911,7.783251,2.486732,10.655979,28.844191,15.877300,-1.253357,6.263115,1.775207,-13.265967,0.000404,13.265753,-1.775809,-6.262817,1.253265,-15.878167,-28.843844,-10.655245,-2.487080,-7.783120,9.510755,21.648856,3.681011,-1.468638,9.972917,0.488892,-4.817308,16.455068,20.198654,3.402363,5.878122,5.166815,-19.461563,-23.948023,-6.845097,-10.000264,-12.175531,7.768430,7.704879,-11.347727,-5.877558,2.777712,-8.443475,-0.274345,23.839024,19.510338,9.048321,17.649382,8.073598,-15.468928,-9.510403,1.602801,-9.268943,-5.524221,9.822931,-4.122996,-20.274477,-9.917348,-9.980575,-19.446173,-0.000017,19.446329,9.979860,9.917701,20.274458,4.122281,-9.822730,5.525240,9.268642,-1.602865,9.511458,15.468226,-8.075048,-17.649199,-9.048274,-19.511304,-23.838240,0.275044,8.443227,-2.778087,5.878487,11.347124,-7.705381,-7.767927,12.176250,9.999602,6.845702,23.948420,19.460916,-5.167768,-5.877561,-3.402656,-20.199048,-16.453858,4.817978,-0.489858,-9.972814,1.468927,-3.682164,-21.649210,-9.510058,7.783228,2.486603,10.656481,28.844159,15.877452,-1.253341,6.263319,1.774796,-13.265946,0.000263,13.265872,-1.776220,-6.262613,1.253281,-15.878015,-28.843716,-10.654743,-2.487047,-7.783143,9.510608,21.648712,3.680544,-1.468699,9.972895,0.489485,-4.817036,16.455560,20.198737,3.402425,5.878350,5.166429,-19.461426,-23.948107,-6.845468,-10.000532,-12.175239,7.768324,7.704985,-11.347971,-5.877181,2.777738,-8.443422,-0.274493,23.839342,19.509946,9.048311,17.649343,8.074488,-15.469214,-9.509975,1.602815,-9.268879,-5.523807,9.823013,-4.122844,-20.274473,-9.917423,-9.980866,-19.446110,0.000684,19.446234,9.979570,9.917992,20.274441,4.121689,-9.822854,5.525654,9.268393,-1.602917,9.510811,15.468657,-8.075637,-17.649047,-9.048235,-19.510711,-23.837922,0.275623,8.443021,-2.777935,5.877917,11.346879,-7.705796,-7.767510,12.175809,10.000008,6.845947,23.948750,19.460380,-5.167183,-5.877333,-3.402899,-20.199374,-16.454601,4.817567,-0.490250,-9.972729,1.469166,-3.681457,-21.649353,-9.509481,7.783318,2.486797,10.655722,28.844286,15.876860,-1.253403,6.263011,1.775418,-13.266025,0.000814,13.265793,-1.775598,-6.262409,1.253219,-15.878607,-28.843909,-10.655502,-2.487176,-7.783054,9.511185,21.648929,3.680076,-1.468460,9.972980,0.489093,-4.817447,16.456051,20.198411,3.402183,5.878006,5.167013,-19.461962,-23.947778,-6.845222,-10.000126,-12.174948,7.768741,7.704570,-11.347601,-5.877751,2.777637,-8.443628,-0.273914,23.838861,19.509554,9.048350,17.649495,8.073900,-15.468782,-9.509547,1.602762,-9.269128,-5.524433,9.822889,-4.123436,-20.274489,-9.917131,-9.980427,-19.446047,0.001385,19.446297,9.980009,9.917551,20.274425,4.121097,-9.822772,5.525029,9.268770,-1.602969,9.511239,15.468372,-8.074747,-17.648895,-9.048196,-19.511103,-23.838403,0.274748,8.442815,-2.778035,5.878294,11.347249,-7.706212,-7.767093,12.176100,9.999740,6.845576,23.949079,19.459843,-5.167570,-5.877677,-3.402532,-20.199701,-16.454109,4.817839,-0.489657,-9.972644,1.469405,-3.681925,-21.649136,-9.510354,7.783407,2.486669,10.656224,28.844093,15.876268,-1.253465,6.263215,1.775007,-13.265906,0.001366,13.265714,-1.776009,-6.262717,1.253313,-15.879199,-28.843782,-10.655000,-2.486982,-7.782964,9.511762,21.648786,3.680783,-1.468821,9.973065,0.488701,-4.817175,16.455308,20.198905,3.401940,5.878233,5.166627,-19.461152,-23.947448,-6.844977,-10.000394,-12.175389,7.768110,7.704154,-11.347846,-5.877374,2.777789,-8.443834,-0.273335,23.839179,19.510147,9.048291,17.649646,8.073311,-15.469068,-9.510194,1.602842,-9.269377,-5.524019,9.822971,-4.122541,-20.274505,-9.916840,-9.980717,-19.446143,0.000325,19.446360,9.979718,9.917843,20.274450,4.120505,-9.822690,5.525442,9.268521,-1.602890,9.511667,15.468086,-8.075335,-17.649125,-9.048255,-19.511495,-23.838085,0.275327,8.443126,-2.778136,5.878671,11.347004,-7.705584,-7.767723,12.176392,9.999471,6.845822,23.948581,19.459307,-5.167956,-5.877449,-3.402775,-20.199207,-16.453618,4.818111,-0.490049,-9.972773,1.469044,-3.682393,-21.649280,-9.509777,7.783272,2.486541,10.656725,28.844221,15.877163,-1.253371,6.263419,1.774596,-13.265985,0.000532,13.265833,-1.776420,-6.262513,1.253251,-15.878304,-28.843654,-10.654499,-2.487110,-7.783100,9.510889,21.648642,3.680315,-1.468582,9.972937,0.488309,-4.816903,16.455799,20.198578,3.402307,5.878461,5.166240,-19.461688,-23.947946,-6.845348,-10.000663,-12.175097,7.768527,7.704783,-11.348091,-5.876997,2.777689,-8.443523,-0.274210,23.839497,19.509755,9.048330,17.649417,8.072723,-15.469353,-9.509766,1.602789,-9.269001,-5.523605,9.823053,-4.123133,-20.274481,-9.917281,-9.981007,-19.446080,0.001026,19.446264,9.979428,9.918135,20.274433,4.121400,-9.822814,5.525856,9.268272,-1.602942,9.511019,15.467801,-8.075924,-17.648973,-9.048216,-19.510902,-23.837767,0.275905,8.442920,-2.777984,5.878101,11.346759,-7.705999,-7.767307,12.175951,9.999203,6.846067,23.948910,19.460118,-5.167372,-5.877221,-3.403017,-20.199534,-16.454361,4.817699,-0.490441,-9.972688,1.469283,-3.681685,-21.649423,-9.509200,7.783361,2.486735,10.655967,28.844349,15.876571,-1.253433,6.263110,1.774185,-13.266063,0.001083,13.265754,-1.775799,-6.262309,1.253189,-15.878896,-28.843847,-10.655257,-2.487238,-7.783010,9.511466,21.648859,3.679847,-1.468343,9.973022,0.488902,-4.817314,16.456291,20.198252,3.402064,5.878117,5.165853,-19.462224,-23.947617,-6.845103,-10.000257,-12.174805,7.768944,7.704367,-11.347721,-5.877567,2.777588,-8.443728,-0.273632,23.839016,19.509363,9.048369,17.649569,8.073612,-15.468922,-9.509338,1.602737,-9.269249,-5.524231,9.822929,-4.123725,-20.274497,-9.916989,-9.980568,-19.446016,-0.000034,19.446327,9.979138,9.917694,20.274417,4.122295,-9.822732,5.526270,9.268648,-1.602995,9.510372,15.468232,-8.076512,-17.649202,-9.048177,-19.512279,-23.838248,0.276484,8.443231,-2.778085,5.879425,11.347129,-7.706415,-7.767937,12.176243,9.998935,6.845696,23.949239,19.460929,-5.167758,-5.876993,-3.402651,-20.199860,-16.455104,4.817971,-0.490833,-9.972816,1.469522,-3.683328,-21.649206,-9.508623,7.783226,2.486606,10.657728,28.844156,15.875979,-1.253339,6.263314,1.773774,-13.265945,0.001635,13.265873,-1.776210,-6.262105,1.253283,-15.879488,-28.844040,-10.654755,-2.487367,-7.783145,9.512043,21.648355,3.680555,-1.468103,9.972893,0.488510,-4.816359,16.455548,20.197926,3.402431,5.878345,5.165467,-19.461413,-23.947288,-6.845474,-10.000525,-12.174514,7.768314,7.703951,-11.347351,-5.877190,2.777487,-8.443417,-0.273053,23.840133,19.509955,9.048408,17.649339,8.073024,-15.469923,-9.509986,1.602684,-9.268873,-5.523817,9.823216,-4.122830,-20.274513,-9.917430,-9.980859,-19.445953,0.000667,19.446390,9.980306,9.917985,20.274401,4.121703,-9.822650,5.524605,9.268399,-1.603047,9.510800,15.467947,-8.077101,-17.649051,-9.048138,-19.510702,-23.837930,0.277063,8.443026,-2.778185,5.877908,11.346885,-7.706830,-7.767520,12.176534,10.000015,6.845941,23.949569,19.460392,-5.168145,-5.877911,-3.402893,-20.200186,-16.454612,4.818243,-0.491225,-9.972731,1.469761,-3.681446,-21.649349,-9.508045,7.783316,2.486478,10.655710,28.844283,15.875387,-1.253402,6.263518,1.775427,-13.266023,0.002187,13.265795,-1.776621,-6.262926,1.253221,-15.880080,-28.843912,-10.654254,-2.487495,-7.783056,9.512620,21.648933,3.680087,-1.467864,9.972978,0.488118,-4.817454,16.456039,20.197599,3.402189,5.878573,5.167023,-19.461949,-23.946958,-6.845228,-10.000794,-12.175688,7.768730,7.703536,-11.347595,-5.876813,2.777386,-8.443623,-0.272474,23.838853,19.509563,9.048447,17.649491,8.072435,-15.468776,-9.509558,1.602632,-9.269122,-5.523403,9.822888,-4.123422,-20.274529,-9.917138,-9.981149,-19.446207,0.001368,19.446453,9.980016,9.918277,20.274384,4.121111,-9.822569,5.525019,9.268150,-1.603099,9.511228,15.467662,-8.074733,-17.648899,-9.048099,-19.511094,-23.837612,0.274734,8.442820,-2.778286,5.878285,11.346640,-7.705158,-7.767103,12.176826,9.999746,6.846187,23.949898,19.459856,-5.168532,-5.877683,-3.403136,-20.200512,-16.454121,4.818515,-0.489648,-9.972646,1.470001,-3.681913,-21.649493,-9.510368,7.783405,2.486350,10.656212,28.844411,15.877769,-1.253464,6.263722,1.775017,-13.266102,-0.000033,13.265716,-1.777031,-6.262722,1.253158,-15.880672,-28.843785,-10.653752,-2.486979,-7.782966,9.513197,21.648789,3.679619,-1.468827,9.973063,0.487726,-4.817182,16.456530,20.198912,3.401946,5.878801,5.166636,-19.462485,-23.948283,-6.844983,-10.001062,-12.175396,7.769147,7.703120,-11.347840,-5.876436,2.777792,-8.443829,-0.271895,23.839171,19.509172,9.048290,17.649643,8.071847,-15.469061,-9.509130,1.602843,-9.269371,-5.522989,9.822969,-4.124014,-20.274464,-9.916847,-9.981439,-19.446144,0.002068,19.446516,9.979725,9.918569,20.274450,4.120519,-9.822487,5.525432,9.267902,-1.602889,9.511656,15.467376,-8.075321,-17.648747,-9.048256,-19.511486,-23.837294,0.275313,8.442614,-2.777881,5.878662,11.346395,-7.705574,-7.766686,12.177117,9.999478,6.846433,23.948573,19.459320,-5.168918,-5.877455,-3.403379,-20.199199,-16.453630,4.818787,-0.490040,-9.972561,1.469038,-3.682381,-21.649636,-9.509791,7.783495,2.486866,10.656713,28.844539,15.877177,-1.253526,6.263926,1.774606,-13.266180,0.000518,13.265637,-1.777442,-6.262518,1.253096,-15.878290,-28.843657,-10.653251,-2.487107,-7.782877,9.510875,21.648646,3.679151,-1.468588,9.973148,0.489303,-4.816910,16.457022,20.198586,3.401703,5.879029,5.166249,-19.463022,-23.947954,-6.844737,-10.001330,-12.175104,7.769564,7.704793,-11.348085,-5.876059,2.777691,-8.444034,-0.274224,23.839489,19.508780,9.048329,17.649794,8.074215,-15.469346,-9.508702,1.602790,-9.269620,-5.524655,9.823051,-4.124606,-20.274480,-9.916555,-9.981730,-19.446081,0.002769,19.446263,9.979435,9.918860,20.274434,4.119927,-9.822816,5.525846,9.267653,-1.602941,9.512084,15.468525,-8.075910,-17.648595,-9.048217,-19.511878,-23.838574,0.275892,8.442409,-2.777981,5.879039,11.346150,-7.705989,-7.766269,12.175944,9.999209,6.846678,23.948902,19.458784,-5.167363,-5.877227,-3.403621,-20.199526,-16.453138,4.817693,-0.490432,-9.972476,1.469277,-3.682849,-21.649059,-9.509214,7.783584,2.486738,10.657215,28.844666,15.876585,-1.253588,6.263105,1.774195,-13.266259,0.001070,13.265559,-1.775789,-6.262314,1.253033,-15.878882,-28.843529,-10.655269,-2.487235,-7.782787,9.511452,21.648502,3.681034,-1.468349,9.973233,0.488911,-4.816638,16.457513,20.198260,3.401461,5.878111,5.165863,-19.463558,-23.947625,-6.844492,-10.000251,-12.174812,7.769981,7.704377,-11.348330,-5.877576,2.777590,-8.444240,-0.273645,23.839807,19.510357,9.048368,17.649946,8.073627,-15.469631,-9.508274,1.602738,-9.269868,-5.524241,9.823132,-4.125198,-20.274497,-9.916264,-9.980561,-19.446018,0.003470,19.446326,9.979145,9.917687,20.274417,4.119335,-9.822734,5.526260,9.268654,-1.602993,9.512512,15.468239,-8.076498,-17.648444,-9.048178,-19.512270,-23.838256,0.276470,8.442203,-2.778082,5.879416,11.347135,-7.706405,-7.765852,12.176236,9.998941,6.845690,23.949232,19.458248,-5.167749,-5.876999,-3.402645,-20.199852,-16.452647,4.817965,-0.490824,-9.972818,1.469516,-3.683317,-21.649203,-9.508636,7.783673,2.486609,10.657716,28.844152,15.875993,-1.253651,6.263309,1.773784,-13.265943,0.001622,13.265480,-1.776200,-6.262110,1.253284,-15.879474,-28.843401,-10.654768,-2.487364,-7.783148,9.512029,21.648359,3.680566,-1.468109,9.973318,0.488519,-4.816366,16.455536,20.197934,3.401218,5.878339,5.165476,-19.461400,-23.947296,-6.844246,-10.000519,-12.174521,7.768304,7.703961,-11.348575,-5.877199,2.777489,-8.443412,-0.273067,23.840125,19.509965,9.048407,17.650098,8.073038,-15.469916,-9.509996,1.602686,-9.270117,-5.523827,9.823214,-4.122816,-20.274513,-9.915972,-9.980852,-19.445955,0.000650,19.446389,9.978855,9.917978,20.274401,4.121717,-9.822652,5.526674,9.268405,-1.603046,9.512940,15.467954,-8.077086,-17.649054,-9.048139,-19.512661,-23.837938,0.277049,8.443031,-2.778183,5.879793,11.346891,-7.706820,-7.767530,12.176527,9.998673,6.845936,23.949561,19.460405,-5.168136,-5.876771,-3.402887,-20.200178,-16.452156,4.818237,-0.491216,-9.972733,1.469756,-3.683785,-21.649346,-9.508059,7.783314,2.486481,10.658218,28.844280,15.875401,-1.253400,6.263513,1.773373,-13.266021,0.002173,13.265797,-1.776611,-6.261906,1.253222,-15.880066,-28.843273,-10.654266,-2.487492,-7.783058,9.512607,21.648215,3.680098,-1.467870,9.972976,0.488127,-4.816094,16.456027,20.197607,3.402194,5.878567,5.165089,-19.461936,-23.946966,-6.845234,-10.000787,-12.174229,7.768720,7.703546,-11.348819,-5.876822,2.777388,-8.443618,-0.272488,23.840443,19.509573,9.048446,17.649487,8.072450,-15.470202,-9.509568,1.602633,-9.269116,-5.523413,9.823295,-4.123408,-20.274529,-9.917146,-9.981142,-19.445892,0.001351,19.446452,9.980023,9.918270,20.274385,4.121125,-9.822571,5.527088,9.268156,-1.603098,9.511218,15.467669,-8.077675,-17.648902,-9.048100,-19.511084,-23.837620,0.277628,8.442825,-2.778284,5.878276,11.346646,-7.707236,-7.767113,12.176819,9.999753,6.846181,23.949890,19.459869,-5.168522,-5.876543,-3.403130,-20.200504,-16.454133,4.818509,-0.491608,-9.972648,1.469995,-3.681902,-21.649489,-9.507482,7.783403,2.486353,10.656200,28.844408,15.874809,-1.253462,6.263717,1.775026,-13.266100,0.002725,13.265718,-1.777022,-6.261702,1.253160,-15.880658,-28.843788,-10.653765,-2.487620,-7.782969,9.513184,21.648793,3.679630,-1.467630,9.973061,0.487735,-4.817188,16.456518,20.197281,3.401952,5.878795,5.166645,-19.462473,-23.946637,-6.844989,-10.001056,-12.173937,7.769137,7.703130,-11.347834,-5.876445,2.777287,-8.443824,-0.271909,23.839164,19.509181,9.048485,17.649639,8.071861,-15.469054,-9.509140,1.602581,-9.269365,-5.522999,9.822967,-4.124000,-20.274545,-9.916854,-9.981432,-19.445828,0.002051,19.446515,9.979732,9.918562,20.274368,4.120533,-9.822489,5.525422,9.267908,-1.603150,9.511646,15.467383,-8.075307,-17.648751,-9.048061,-19.511476,-23.837301,0.275299,8.442619,-2.778384,5.878653,11.346401,-7.707651,-7.766696,12.177110,9.999484,6.846427,23.950219,19.459333,-5.168909,-5.877460,-3.403373,-20.200831,-16.453642,4.818780,-0.490030,-9.972563,1.470234,-3.682370,-21.649633,-9.509804,7.783492,2.486225,10.656701,28.844535,15.877191,-1.253525,6.263921,1.774616,-13.266179,0.003276,13.265639,-1.777432,-6.262523,1.253097,-15.881250,-28.843660,-10.653263,-2.487104,-7.782879,9.513761,21.648649,3.679163,-1.468594,9.973146,0.487343,-4.816916,16.457010,20.198594,3.401709,5.879023,5.166259,-19.463009,-23.946308,-6.844743,-10.001324,-12.175111,7.769554,7.702714,-11.348079,-5.876068,2.777693,-8.444029,-0.271330,23.839482,19.508789,9.048328,17.649791,8.071272,-15.469339,-9.508712,1.602792,-9.269614,-5.522585,9.823049,-4.124592,-20.274561,-9.916562,-9.981723,-19.446083,0.002752,19.446578,9.979442,9.918853,20.274434,4.119941,-9.822407,5.525836,9.267659,-1.602940,9.512074,15.467098,-8.075895,-17.648599,-9.048218,-19.511868,-23.836983,0.275878,8.442414,-2.778485,5.879030,11.346156,-7.705979,-7.766279,12.177402,9.999216,6.846672,23.948894,19.458797,-5.169295,-5.877232,-3.403615,-20.199518,-16.453150,4.819052,-0.490422,-9.972478,1.469271,-3.682838,-21.649776,-9.509227,7.783582,2.486097,10.657203,28.844663,15.876599,-1.253587,6.264125,1.774205,-13.266257,0.001057,13.265560,-1.777843,-6.262319,1.253035,-15.878867,-28.843532,-10.652762,-2.487232,-7.782790,9.511438,21.648506,3.678695,-1.468354,9.973231,0.486951,-4.816644,16.457501,20.198268,3.401467,5.879251,5.165872,-19.463545,-23.947633,-6.844498,-10.001592,-12.174819,7.769971,7.704387,-11.348324,-5.875691,2.777593,-8.444235,-0.273659,23.839800,19.508397,9.048367,17.649942,8.073641,-15.469624,-9.508284,1.602739,-9.269862,-5.522171,9.823130,-4.125184,-20.274496,-9.916271,-9.982013,-19.446019,-0.000067,19.446641,9.979152,9.917680,20.274336,4.119349,-9.822736,5.528329,9.267410,-1.602992,9.510352,15.466812,-8.076484,-17.649210,-9.047983,-19.512260,-23.838263,0.279365,8.442208,-2.778080,5.877513,11.345911,-7.706395,-7.767957,12.177694,9.998948,6.845684,23.950877,19.458261,-5.167740,-5.875859,-3.403858,-20.199844,-16.455127,4.819324,-0.490814,-9.972820,1.470713,-3.683306,-21.649199,-9.505751,7.783671,2.486613,10.655185,28.844791,15.876007,-1.253336];
figure

plot(1000*t(1:50),mysig(1:50));

Ys = fft(mysig);

P2 = abs(Ys/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);
f = fs*(0:(L/2))/L;
figure 
plot(f,P1) 

%myfilt was created with bw_low_pass(filter, signal[i])); in example.c

myfilt = [0.000000,0.648547,3.638082,8.978932,13.458282,14.761940,12.805277,7.357329,0.828866,-1.396873,1.633614,5.802922,8.306726,7.234034,0.390962,-9.715025,-17.145067,-19.435860,-16.531784,-8.399250,1.170960,6.504857,6.809711,4.187058,-0.002871,-2.248585,1.126974,8.083771,14.204453,17.431578,15.437738,6.903520,-3.885360,-11.541784,-14.731262,-12.997335,-6.844093,-1.152772,-0.170767,-2.816508,-7.045977,-11.060692,-10.587059,-3.612006,6.024643,14.339626,19.284300,17.967283,10.456215,2.083336,-3.190601,-4.907050,-2.476098,2.323331,4.073909,0.554318,-5.891789,-13.316025,-18.856325,-17.895618,-10.344814,-0.791090,7.684208,12.756758,11.618012,6.125643,1.715445,0.566964,2.656484,8.112129,13.398720,13.250331,7.406894,-1.425279,-11.274334,-18.073847,-17.702236,-11.906745,-4.991226,0.909556,3.206855,0.161229,-4.479020,-5.928767,-3.461069,2.826829,11.985086,18.838291,19.025309,13.705525,5.184724,-4.318535,-9.993399,-9.224957,-5.245501,-1.484518,0.455128,-2.023788,-8.739885,-14.438735,-15.421350,-11.649251,-3.069779,7.936276,15.344042,16.378448,12.937366,6.675022,0.339754,-1.373547,1.885946,5.951122,8.277898,7.143807,0.347861,-9.698494,-17.113686,-19.424028,-16.539516,-8.409852,1.168028,6.508156,6.813219,4.187654,-0.004232,-2.249754,1.126903,8.084312,14.204845,17.431561,15.437505,6.903336,-3.885397,-11.541740,-14.731225,-12.997330,-6.844108,-1.152793,-0.170777,-2.816514,-7.046013,-11.060771,-10.587142,-3.612045,6.024664,14.339680,19.284323,17.967230,10.456114,2.083257,-3.190620,-4.907019,-2.476049,2.323350,4.073877,0.554271,-5.891803,-13.315997,-18.856285,-17.895594,-10.344806,-0.791064,7.684274,12.756833,11.618057,6.125651,1.715438,0.566975,2.656540,8.112209,13.398753,13.250287,7.406819,-1.425327,-11.274339,-18.073822,-17.702206,-11.906728,-4.991231,0.909529,3.206817,0.161201,-4.479032,-5.928772,-3.461058,2.826891,11.985190,18.838377,19.025328,13.705494,5.184677,-4.318562,-9.993381,-9.224902,-5.245443,-1.484484,0.455131,-2.023803,-8.739891,-14.438724,-15.421339,-11.649251,-3.069777,7.936286,15.344050,16.378443,12.937326,6.674951,0.339704,-1.373525,1.886014,5.951172,8.277896,7.143753,0.347776,-9.698558,-17.113697,-19.424006,-16.539490,-8.409840,1.168029,6.508160,6.813231,4.187643,-0.004288,-2.249822,1.126865,8.084313,14.204879,17.431591,15.437470,6.903224,-3.885514,-11.541794,-14.731200,-12.997253,-6.844033,-1.152771,-0.170792,-2.816497,-7.045931,-11.060645,-10.587016,-3.611958,6.024711,14.339729,19.284410,17.967340,10.456201,2.083280,-3.190672,-4.907119,-2.476150,2.323302,4.073909,0.554335,-5.891831,-13.316183,-18.856535,-17.895761,-10.344847,-0.791010,7.684360,12.756853,11.617950,6.125488,1.715324,0.566929,2.656541,8.112255,13.398826,13.250325,7.406762,-1.425504,-11.274571,-18.073982,-17.702213,-11.906611,-4.991091,0.909576,3.206705,0.160990,-4.479207,-5.928824,-3.460989,2.826997,11.985202,18.838238,19.025129,13.705350,5.184618,-4.318545,-9.993315,-9.224857,-5.245466,-1.484543,0.455076,-2.023859,-8.739932,-14.438707,-15.421258,-11.649129,-3.069645,7.936379,15.344054,16.378374,12.937275,6.674978,0.339763,-1.373542,1.885886,5.951003,8.277772,7.143714,0.347819,-9.698492,-17.113705,-19.424124,-16.539648,-8.409950,1.167988,6.508183,6.813300,4.187708,-0.004267,-2.249838,1.126830,8.084263,14.204842,17.431610,15.437536,6.903268,-3.885551,-11.541917,-14.731362,-12.997370,-6.844039,-1.152686,-0.170719,-2.816558,-7.046148,-11.060908,-10.587183,-3.611975,6.024802,14.339828,19.284380,17.967127,10.455920,2.083092,-3.190710,-4.907012,-2.475943,2.323455,4.073861,0.554146,-5.891961,-13.316138,-18.856340,-17.895510,-10.344640,-0.790935,7.684293,12.756731,11.617882,6.125510,1.715412,0.567053,2.656653,8.112267,13.398705,13.250170,7.406697,-1.425431,-11.274394,-18.073793,-17.702139,-11.906713,-4.991284,0.909441,3.206719,0.161146,-4.478993,-5.928690,-3.461032,2.826822,11.985045,18.838205,19.025215,13.705478,5.184690,-4.318601,-9.993466,-9.224990,-5.245508,-1.484512,0.455139,-2.023789,-8.739900,-14.438767,-15.421411,-11.649308,-3.069774,7.936344,15.344131,16.378508,12.937314,6.674813,0.339487,-1.373730,1.885885,5.951162,8.277987,7.143812,0.347686,-9.698745,-17.113855,-19.424078,-16.539455,-8.409698,1.168185,6.508217,6.813168,4.187524,-0.004373,-2.249808,1.126974,8.084451,14.204973,17.431581,15.437337,6.903044,-3.885643,-11.541842,-14.731169,-12.997148,-6.843938,-1.152792,-0.170933,-2.816692,-7.046105,-11.060702,-10.586905,-3.611779,6.024809,14.339713,19.284317,17.967201,10.456083,2.083252,-3.190619,-4.907024,-2.476040,2.323353,4.073823,0.554164,-5.891924,-13.316087,-18.856287,-17.895506,-10.344716,-0.791053,7.684200,12.756721,11.617975,6.125649,1.715461,0.566926,2.656425,8.112101,13.398697,13.250299,7.406862,-1.425380,-11.274533,-18.073999,-17.702209,-11.906606,-4.991096,0.909625,3.206829,0.161118,-4.479136,-5.928839,-3.461099,2.826859,11.985169,18.838360,19.025297,13.705392,5.184447,-4.318854,-9.993589,-9.224956,-5.245359,-1.484334,0.455195,-2.023951,-8.740169,-14.438937,-15.421415,-11.649251,-3.069781,7.936241,15.343974,16.378401,12.937408,6.675171,0.339969,-1.373350,1.886067,5.951224,8.278039,7.143869,0.347713,-9.698771,-17.113947,-19.424200,-16.539528,-8.409693,1.168223,6.508275,6.813278,4.187675,-0.004250,-2.249751,1.126977,8.084403,14.204906,17.431606,15.437515,6.903260,-3.885518,-11.541786,-14.731056,-12.996897,-6.843615,-1.152558,-0.170897,-2.816854,-7.046389,-11.060987,-10.587090,-3.611837,6.024870,14.339873,19.284506,17.967342,10.456150,2.083243,-3.190711,-4.907164,-2.476155,2.323280,4.073764,0.554133,-5.891881,-13.315953,-18.856070,-17.895247,-10.344514,-0.791010,7.684069,12.756472,11.617693,6.125455,1.715489,0.567223,2.656884,8.112531,13.398959,13.250387,7.406841,-1.425453,-11.274622,-18.074112,-17.702385,-11.906791,-4.991176,0.909668,3.206897,0.161154,-4.479088,-5.928751,-3.461019,2.826890,11.985150,18.838287,19.025221,13.705451,5.184708,-4.318521,-9.993349,-9.224838,-5.245270,-1.484177,0.455406,-2.023783,-8.740124,-14.439028,-15.421551,-11.649255,-3.069578,7.936479,15.344054,16.378334,12.937265,6.674972,0.339795,-1.373393,1.886093,5.951148,8.277822,7.143631,0.347557,-9.698801,-17.113804,-19.423862,-16.539066,-8.409285,1.168409,6.508177,6.812958,4.187283,-0.004532,-2.249830,1.127054,8.084576,14.205132,17.431791,15.437596,6.903324,-3.885413,-11.541779,-14.731326,-12.997440,-6.844221,-1.152965,-0.170952,-2.816572,-7.045944,-11.060587,-10.586819,-3.611682,6.024872,14.339675,19.284170,17.966995,10.455897,2.083174,-3.190564,-4.906870,-2.475839,2.323561,4.074031,0.554351,-5.891858,-13.316227,-18.856565,-17.895765,-10.344834,-0.790978,7.684394,12.756801,11.617784,6.125349,1.715340,0.567065,2.656730,8.112440,13.398898,13.250260,7.406685,-1.425525,-11.274588,-18.073990,-17.702154,-11.906454,-4.990811,0.909929,3.206964,0.161042,-4.479310,-5.928982,-3.461126,2.826922,11.985147,18.838121,19.024996,13.705305,5.184672,-4.318421,-9.993131,-9.224683,-5.245389,-1.484581,0.454904,-2.024171,-8.740254,-14.438861,-15.421185,-11.648842,-3.069204,7.936778,15.344218,16.378292,12.937021,6.674629,0.339477,-1.373597,1.886062,5.951282,8.278035,7.143871,0.347850,-9.698503,-17.113684,-19.424078,-16.539608,-8.409953,1.167905,6.508048,6.813179,4.187604,-0.004342,-2.249763,1.127096,8.084562,14.205018,17.431610,15.437351,6.903010,-3.885692,-11.541886,-14.731234,-12.997188,-6.843851,-1.152558,-0.170638,-2.816464,-7.046059,-11.060861,-10.587155,-3.611943,6.024823,14.339806,19.284239,17.966825,10.455606,2.082977,-3.190600,-4.906767,-2.475649,2.323675,4.073909,0.554041,-5.892179,-13.316431,-18.856569,-17.895542,-10.344488,-0.790651,7.684654,12.757023,11.617976,6.125442,1.715275,0.566890,2.656535,8.112288,13.398838,13.250290,7.406739,-1.425437,-11.274357,-18.073616,-17.701853,-11.906477,-4.991217,0.909315,3.206422,0.160797,-4.479221,-5.928733,-3.460897,2.827150,11.985474,18.838514,19.025274,13.705306,5.184368,-4.318909,-9.993599,-9.224957,-5.245411,-1.484385,0.455264,-2.023730,-8.739880,-14.438696,-15.421288,-11.649199,-3.069711,7.936336,15.344032,16.378351,12.937103,6.674553,0.339333,-1.373624,1.886165,5.951425,8.278131,7.143798,0.347549,-9.698904,-17.113989,-19.424179,-16.539455,-8.409583,1.168312,6.508302,6.813263,4.187634,-0.004297,-2.249748,1.127045,8.084486,14.204919,17.431393,15.436971,6.902614,-3.885893,-11.541808,-14.730920,-12.996772,-6.843557,-1.152567,-0.170933,-2.816885,-7.046425,-11.061009,-10.587048,-3.611735,6.024978,14.339957,19.284536,17.967287,10.456046,2.083162,-3.190752,-4.907161,-2.476105,2.323328,4.073752,0.554070,-5.891963,-13.316037,-18.856104,-17.895189,-10.344404,-0.790901,7.684155,12.756497,11.617644,6.125355,1.715289,0.566875,2.656549,8.112414,13.399025,13.250453,7.406805,-1.425582,-11.274765,-18.074167,-17.702330,-11.906697,-4.991094,0.909719,3.206888,0.161097,-4.479128,-5.928743,-3.460970,2.826984,11.985254,18.838329,19.025137,13.705118,5.184069,-4.319191,-9.993663,-9.224757,-5.245062,-1.484059,0.455383,-2.023898,-8.740230,-14.439055,-15.421515,-11.649179,-3.069461,7.936591,15.344101,16.378317,12.937208,6.674891,0.339740,-1.373379,1.886143,5.951163,8.277712,7.143331,0.347171,-9.699051,-17.113840,-19.423782,-16.538963,-8.409183,1.168476,6.508194,6.812946,4.187249,-0.004576,-2.249851,1.127006,8.084415,14.204929,17.431675,15.437553,6.903271,-3.885491,-11.541853,-14.731360,-12.997400,-6.844134,-1.152916,-0.170965,-2.816617,-7.046000,-11.060617,-10.586771,-3.611574,6.024981,14.339755,19.284195,17.966938,10.455760,2.082916,-3.190974,-4.907267,-2.475988,2.323641,4.074131,0.554345,-5.891959,-13.316349,-18.856613,-17.895700,-10.344712,-0.790866,7.684475,12.756824,11.617736,6.125286,1.715310,0.567070,2.656775,8.112514,13.398935,13.250189,7.406430,-1.425986,-11.275070,-18.074221,-17.702082,-11.906270,-4.990681,0.909966,3.206922,0.160971,-4.479343,-5.928962,-3.461072,2.827014,11.985248,18.838163,19.024961,13.705223,5.184560,-4.318521,-9.993159,-9.224647,-5.245341,-1.484544,0.454906,-2.024231,-8.740338,-14.438902,-15.421227,-11.649069,-3.069734,7.936091,15.343665,16.378096,12.937265,6.675231,0.340224,-1.372947,1.886396,5.951168,8.277513,7.143073,0.346941,-9.699286,-17.114202,-19.424353,-16.539518,-8.409345,1.168791,6.508778,6.813589,4.187713,-0.004539,-2.250197,1.126610,8.084197,14.204906,17.431847,15.437867,6.903553,-3.885345,-11.541836,-14.731503,-12.997698,-6.844451,-1.153122,-0.171085,-2.816841,-7.046439,-11.061024,-10.586826,-3.611297,6.025441,14.340307,19.284599,17.966951,10.455508,2.082701,-3.191022,-4.907151,-2.475754,2.323845,4.074169,0.554253,-5.892098,-13.316528,-18.856770,-17.895718,-10.344604,-0.790736,7.684575,12.756925,11.617914,6.125509,1.715435,0.567073,2.656749,8.112443,13.398799,13.250116,7.406509,-1.425787,-11.274787,-18.073952,-17.702011,-11.906428,-4.990940,0.909689,3.206700,0.160947,-4.479136,-5.928661,-3.460744,2.827495,11.985957,18.838888,19.025335,13.705050,5.183918,-4.319376,-9.993881,-9.224936,-5.245132,-1.484032,0.455481,-2.023760,-8.740129,-14.439039,-15.421536,-11.649197,-3.069466,7.936688,15.344367,16.378622,12.937387,6.674924,0.339605,-1.373724,1.885727,5.950897,8.277617,7.143192,0.346815,-9.699488,-17.114056,-19.423672,-16.538605,-8.408706,1.168866,6.508294,6.812764,4.186925,-0.004926,-2.250054,1.127169,8.084924,14.205502,17.432070,15.437638,6.902977,-3.886038,-11.542379,-14.731703,-12.997546,-6.844175,-1.152990,-0.171060,-2.816564,-7.045720,-11.060164,-10.586265,-3.611231,6.024977,14.339441,19.283716,17.966434,10.455478,2.083137,-3.190261,-4.906398,-2.475335,2.323821,4.073771,0.553673,-5.892623,-13.316832,-18.856785,-17.895510,-10.344349,-0.790514,7.684841,12.757228,11.618104,6.125524,1.715304,0.566768,2.656312,8.112078,13.398637,13.250153,7.406798,-1.425259,-11.274281,-18.073706,-17.702045,-11.906712,-4.991395,0.909270,3.206470,0.160900,-4.479078,-5.928591,-3.460727,2.827372,11.985588,18.838371,19.024967,13.704979,5.184100,-4.318984,-9.993409,-9.224638,-5.245112,-1.484167,0.455280,-2.024011,-8.740333,-14.439106,-15.421525,-11.649157,-3.069347,7.936860,15.344476,16.378622,12.937287,6.674750,0.339480,-1.373699,1.885834,5.950983,8.277741,7.143603,0.347648,-9.698571,-17.113598,-19.423851,-16.539282,-8.409671,1.167984,6.507899,6.812932,4.187481,-0.004156,-2.249300,1.127618,8.084998,14.205421,17.432016,15.437551,6.902788,-3.886249,-11.542527,-14.731746,-12.997380,-6.843666,-1.152193,-0.170328,-2.816272,-7.045989,-11.060931,-10.587314,-3.612101,6.024709,14.339824,19.284573,17.967510,10.456357,2.083446,-3.190562,-4.907157,-2.476350,2.322906,4.073308,0.553661,-5.892521,-13.316886,-18.856888,-17.895376,-10.343928,-0.790019,7.685170,12.757227,11.617720,6.124912,1.714783,0.566573,2.656509,8.112631,13.399353,13.250682,7.406890,-1.425609,-11.274947,-18.074455,-17.702562,-11.906814,-4.991167,0.909545,3.206530,0.160768,-4.479130,-5.928412,-3.460413,2.827684,11.985785,18.838366,19.024792,13.704741,5.183856,-4.319161,-9.993403,-9.224467,-5.244918,-1.484046,0.455278,-2.024145,-8.740486,-14.439153,-15.421466,-11.649010,-3.069106,7.937093,15.344575,16.378601,12.937200,6.674615,0.339385,-1.373662,1.885973,5.951152,8.277869,7.143567,0.347413,-9.698860,-17.113800,-19.423918,-16.539175,-8.409408,1.168282,6.508146,6.813089,4.187485,-0.004269,-2.249344,1.127735,8.085119,14.205275,17.431458,15.436775,6.902204,-3.886379,-11.542196,-14.731090,-12.996671,-6.843245,-1.152224,-0.170725,-2.816855,-7.046529,-11.061171,-10.587144,-3.611658,6.025209,14.340214,19.284714,17.967360,10.456085,2.083255,-3.190632,-4.907133,-2.476242,2.322999,4.073276,0.553630,-5.892184,-13.315993,-18.855804,-17.894686,-10.343893,-0.790612,7.684146,12.756210,11.617170,6.124975,1.715339,0.567405,2.657302,8.113069,13.399338,13.250415,7.406632,-1.425799,-11.275105,-18.074520,-17.702488,-11.906670,-4.990942,0.910017,3.207270,0.161461,-4.478812,-5.928561,-3.461031,2.826727,11.984913,18.837969,19.024939,13.705370,5.184816,-4.318276,-9.992985,-9.224584,-5.245464,-1.484841,0.454537,-2.024573,-8.740561,-14.439039,-15.421352,-11.648918,-3.068973,7.937201,15.344569,16.378523,12.937079,6.674404,0.339137,-1.373796,1.885988,5.951291,8.278184,7.144014,0.347739,-9.698826,-17.114019,-19.424335,-16.539684,-8.409766,1.168216,6.508273,6.813216,4.187467,-0.004447,-2.249639,1.127335,8.084736,14.205126,17.431599,15.437129,6.902716,-3.885886,-11.542001,-14.731235,-12.996995,-6.843654,-1.152629,-0.170955,-2.816853,-7.046386,-11.060922,-10.586800,-3.611342,6.025397,14.340317,19.284742,17.967222,10.455719,2.082728,-3.191119,-4.907332,-2.476040,2.323562,4.074046,0.554282,-5.891993,-13.316328,-18.856518,-17.895569,-10.344607,-0.790806,7.684501,12.756915,11.618023,6.125699,1.715644,0.567315,2.657164,8.113119,13.399422,13.250216,7.406066,-1.426494,-11.275572,-18.074528,-17.702034,-11.905953,-4.990282,0.910344,3.207135,0.160889,-4.479629,-5.929250,-3.461250,2.827060,11.985656,18.838850,19.025591,13.705517,5.184506,-4.318674,-9.993125,-9.224469,-5.245299,-1.484743,0.454523,-2.024718,-8.740689,-14.438867,-15.420788,-11.648205,-3.068441,7.937348,15.344262,16.377886,12.936419,6.674006,0.339134,-1.373407,1.886600,5.951824,8.278401,7.143869,0.347395,-9.699104,-17.114109,-19.424288,-16.539534,-8.409540,1.168396,6.508369,6.813395,4.187823,-0.004067,-2.249394,1.127397,8.084560,14.204735,17.431170,15.436806,6.902557,-3.885788,-11.541642,-14.730810,-12.996696,-6.843553,-1.152737,-0.171191,-2.817081,-7.046539,-11.060957,-10.586672,-3.611116,6.025586,14.340362,19.284565,17.966860,10.455384,2.082592,-3.191068,-4.907151,-2.475794,2.323715,4.074011,0.554169,-5.892065,-13.316369,-18.856512,-17.895475,-10.344501,-0.790768,7.684505,12.756894,11.617944,6.125608,1.715597,0.567232,2.656822,8.112384,13.398546,13.249661,7.406050,-1.426002,-11.274696,-18.073612,-17.701511,-11.905978,-4.990750,0.909590,3.206368,0.160458,-4.479584,-5.928859,-3.460696,2.827612,11.986005,18.838884,19.025425,13.705312,5.184229,-4.319210,-9.993940,-9.225235,-5.245626,-1.484505,0.455268,-2.023658,-8.739747,-14.438455,-15.420994,-11.648959,-3.069581,7.936287,15.343779,16.378088,12.937157,6.675059,0.340105,-1.372919,1.886572,5.951614,8.278305,7.143816,0.347140,-9.699574,-17.114550,-19.424465,-16.539351,-8.409038,1.169010,6.508817,6.813529,4.187619,-0.004625,-2.250180,1.126750,8.084358,14.205016,17.431871,15.437741,6.903306,-3.885571,-11.541879,-14.731103,-12.996714,-6.843334,-1.152561,-0.171190,-2.817191,-7.046679,-11.061041,-10.586644,-3.611048,6.025636,14.340438,19.284639,17.966843,10.455309,2.082539,-3.191108,-4.907148,-2.475654,2.323943,4.074146,0.554127,-5.892243,-13.316586,-18.856607,-17.895357,-10.344264,-0.790540,7.684676,12.756942,11.617828,6.125401,1.715381,0.567077,2.656832,8.112588,13.398873,13.250039,7.406331,-1.426013,-11.275002,-18.074032,-17.701920,-11.906268,-4.990785,0.909756,3.206479,0.160395,-4.479692,-5.928885,-3.460607,2.827819,11.986235,18.838953,19.025219,13.704865,5.183705,-4.319558,-9.993930,-9.224866,-5.245040,-1.483959,0.455486,-2.023878,-8.740295,-14.439121,-15.421503,-11.649054,-3.069220,7.936924,15.344462,16.378584,12.937270,6.674830,0.339850,-1.372951,1.886633,5.951379,8.277578,7.142880,0.346485,-9.699674,-17.114092,-19.423634,-16.538490,-8.408502,1.169046,6.508359,6.812739,4.186841,-0.005023,-2.250049,1.127307,8.085090,14.205619,17.432098,15.437551,6.902922,-3.885856,-11.542062,-14.731502,-12.997479,-6.844136,-1.152969,-0.171070,-2.816606,-7.045811,-11.060234,-10.586189,-3.611024,6.025197,14.339607,19.283770,17.966314,10.455266,2.082973,-3.190342,-4.906392,-2.475235,2.323950,4.073920,0.553913,-5.892392,-13.316801,-18.856884,-17.895508,-10.344189,-0.790281,7.685049,12.757295,11.617998,6.125378,1.715235,0.566781,2.656407,8.112226,13.398707,13.250071,7.406618,-1.425484,-11.274494,-18.073786,-17.701906,-11.906302,-4.990716,0.909946,3.206743,0.160743,-4.479317,-5.928655,-3.460602,2.827616,11.985820,18.838446,19.024878,13.704807,5.183884,-4.319173,-9.993461,-9.224567,-5.245018,-1.484094,0.455285,-2.024130,-8.740499,-14.439177,-15.421437,-11.648899,-3.068977,7.937157,15.344561,16.378551,12.937154,6.674593,0.339385,-1.373664,1.885931,5.951056,8.277764,7.143517,0.347433,-9.698792,-17.113712,-19.423847,-16.539152,-8.409441,1.168172,6.507957,6.812829,4.187041,-0.004996,-2.250100,1.127352,8.085224,14.205759,17.432154,15.437388,6.902461,-3.886508,-11.542635,-14.731740,-12.997271,-6.843512,-1.152120,-0.170360,-2.816353,-7.046093,-11.060990,-10.587223,-3.611888,6.024926,14.339986,19.284624,17.967394,10.456148,2.083281,-3.190552,-4.906681,-2.475259,2.324075,4.073820,0.553451,-5.892986,-13.317204,-18.856907,-17.895161,-10.343671,-0.789828,7.685304,12.757268,11.617634,6.124792,1.714721,0.566578,2.656596,8.112779,13.399427,13.250603,7.406712,-1.425780,-11.274880,-18.073946,-17.701832,-11.906331,-4.991062,0.909474,3.206428,0.160684,-4.479150,-5.928373,-3.460328,2.827853,11.985990,18.838459,19.024725,13.704575,5.183630,-4.319360,-9.993456,-9.224391,-5.244820,-1.483972,0.455279,-2.024279,-8.740683,-14.439266,-15.421448,-11.648863,-3.068850,7.937334,15.344669,16.378561,12.937080,6.674451,0.339278,-1.373631,1.886074,5.951231,8.277893,7.143478,0.347195,-9.699083,-17.113913,-19.423912,-16.539043,-8.409195,1.168384,6.508022,6.812860,4.187301,-0.004348,-2.249282,1.127901,8.085274,14.205369,17.431477,15.436655,6.901963,-3.886602,-11.542323,-14.731112,-12.996569,-6.843081,-1.152140,-0.170755,-2.816940,-7.046637,-11.061231,-10.587074,-3.611555,6.025195,14.340128,19.284641,17.967264,10.455947,2.083127,-3.190725,-4.907150,-2.476150,2.323101,4.073259,0.553506,-5.892353,-13.316163,-18.855871,-17.894571,-10.343677,-0.790397,7.684314,12.756260,11.617072,6.124776,1.714940,0.566711,2.656631,8.112834,13.399470,13.250547,7.406561,-1.426058,-11.275392,-18.074631,-17.702381,-11.906486,-4.990781,0.910118,3.207251,0.161348,-4.478889,-5.928543,-3.460930,2.826917,11.985123,18.838055,19.024864,13.705203,5.184595,-4.318472,-9.993038,-9.224441,-5.245014,-1.484024,0.455346,-2.024290,-8.740792,-14.439344,-15.421548,-11.649325,-3.069855,7.936170,15.343836,16.378092,12.936729,6.674159,0.339341,-1.372986,1.886866,5.951369,8.277118,7.142316,0.346312,-9.699458,-17.114000,-19.424002,-16.538975,-8.408549,1.169396,6.508554,6.812441,4.186287,-0.005371,-2.250033,1.127450,8.085052,14.205373,17.431816,15.437359,6.902931,-3.885635,-11.541842,-14.731489,-12.997594,-6.844068,-1.152565,-0.170572,-2.816417,-7.046020,-11.060369,-10.585741,-3.610187,6.025719,14.339518,19.283546,17.757633];
figure

plot(1000*t(1:50),myfilt(1:50));

Ys = fft(myfilt);
P2 = abs(Ys/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);
f = fs*(0:(L/2))/L;
figure 
plot(f,P1) 
